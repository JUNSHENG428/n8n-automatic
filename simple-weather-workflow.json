{
  "name": "æ¯æ—¥å¤©æ°”é¢„æŠ¥é‚®ä»¶é€šçŸ¥",
  "nodes": [
    {
      "id": "manual_trigger",
      "name": "æ‰‹åŠ¨è§¦å‘",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [250, 300],
      "parameters": {}
    },
    {
      "id": "set_config",
      "name": "è®¾ç½®å‚æ•°",
      "type": "n8n-nodes-base.set",
      "typeVersion": 1,
      "position": [450, 300],
      "parameters": {
        "keepOnlySet": false,
        "values": {
          "string": [
            {
              "name": "city",
              "value": "Beijing"
            },
            {
              "name": "apiKey",
              "value": "your_weather_api_key_here"
            },
            {
              "name": "recipientEmail",
              "value": "recipient@example.com"
            }
          ]
        },
        "options": {}
      }
    },
    {
      "id": "http_weather",
      "name": "è·å–å¤©æ°”",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 3,
      "position": [650, 300],
      "parameters": {
        "method": "GET",
        "url": "https://api.weatherapi.com/v1/forecast.json",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "={{ $json.apiKey }}"
            },
            {
              "name": "q",
              "value": "={{ $json.city }}"
            },
            {
              "name": "days",
              "value": "3"
            },
            {
              "name": "lang",
              "value": "zh"
            }
          ]
        },
        "options": {}
      }
    },
    {
      "id": "format_email",
      "name": "æ ¼å¼åŒ–é‚®ä»¶",
      "type": "n8n-nodes-base.code",
      "typeVersion": 1,
      "position": [850, 300],
      "parameters": {
        "jsCode": "// è·å–å¤©æ°”æ•°æ®\nconst weatherData = items[0].json;\nconst location = weatherData.location;\nconst current = weatherData.current;\nconst forecast = weatherData.forecast.forecastday;\n\n// ç”Ÿæˆé‚®ä»¶æ ‡é¢˜\nconst subject = `${location.name} å¤©æ°”é¢„æŠ¥ - ${current.condition.text} ${current.temp_c}Â°C`;\n\n// ç”Ÿæˆé‚®ä»¶å†…å®¹\nlet emailBody = `\n<h2>ğŸ“ ${location.name}, ${location.country}</h2>\n<p>æ›´æ–°æ—¶é—´: ${new Date(location.localtime).toLocaleString('zh-CN')}</p>\n\n<h3>ğŸŒ¡ï¸ å½“å‰å¤©æ°”</h3>\n<ul>\n  <li>æ¸©åº¦: ${current.temp_c}Â°C (ä½“æ„Ÿ ${current.feelslike_c}Â°C)</li>\n  <li>å¤©æ°”: ${current.condition.text}</li>\n  <li>æ¹¿åº¦: ${current.humidity}%</li>\n  <li>é£é€Ÿ: ${current.wind_kph} km/h ${current.wind_dir}</li>\n  <li>èƒ½è§åº¦: ${current.vis_km} km</li>\n  <li>ç´«å¤–çº¿æŒ‡æ•°: ${current.uv}</li>\n</ul>\n\n<h3>ğŸ“… æœªæ¥ä¸‰å¤©é¢„æŠ¥</h3>\n`;\n\n// æ·»åŠ æœªæ¥å¤©æ°”\nforecast.forEach(day => {\n  emailBody += `\n<h4>${new Date(day.date).toLocaleDateString('zh-CN', { weekday: 'long', month: 'long', day: 'numeric' })}</h4>\n<ul>\n  <li>æ¸©åº¦: ${day.day.mintemp_c}Â°C - ${day.day.maxtemp_c}Â°C</li>\n  <li>å¤©æ°”: ${day.day.condition.text}</li>\n  <li>é™é›¨æ¦‚ç‡: ${day.day.daily_chance_of_rain}%</li>\n  <li>æ—¥å‡º/æ—¥è½: ${day.astro.sunrise} / ${day.astro.sunset}</li>\n</ul>\n`;\n});\n\n// æ·»åŠ å»ºè®®\nlet suggestions = '<h3>ğŸ’¡ ä»Šæ—¥å»ºè®®</h3><ul>';\nif (current.temp_c < 10) suggestions += '<li>ğŸ§¥ ä»Šå¤©è¾ƒå†·ï¼Œè¯·æ³¨æ„ä¿æš–</li>';\nif (current.temp_c > 30) suggestions += '<li>ğŸŒ ä»Šå¤©è¾ƒçƒ­ï¼Œè¯·æ³¨æ„é˜²æ™’</li>';\nif (forecast[0].day.daily_chance_of_rain > 50) suggestions += '<li>â˜” ä»Šå¤©å¯èƒ½ä¸‹é›¨ï¼Œè¯·æºå¸¦é›¨å…·</li>';\nif (current.uv > 6) suggestions += '<li>ğŸ•¶ï¸ ç´«å¤–çº¿è¾ƒå¼ºï¼Œå»ºè®®æ¶‚æŠ¹é˜²æ™’éœœ</li>';\nsuggestions += '</ul>';\n\nemailBody += suggestions;\n\n// è®¾ç½®æ”¶ä»¶äººé‚®ç®±\nconst recipientEmail = items[0].json.recipientEmail || 'user@example.com';\n\nreturn [{\n  json: {\n    to: recipientEmail,\n    subject: subject,\n    html: emailBody\n  }\n}];"
      }
    },
    {
      "id": "send_email",
      "name": "å‘é€é‚®ä»¶",
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2,
      "position": [1050, 300],
      "parameters": {
        "fromEmail": "weather-notification@yourdomain.com",
        "toEmail": "={{ $json.to }}",
        "subject": "={{ $json.subject }}",
        "emailType": "html",
        "message": "={{ $json.html }}",
        "options": {}
      }
    }
  ],
  "connections": {
    "æ‰‹åŠ¨è§¦å‘": {
      "main": [
        [
          {
            "node": "è®¾ç½®å‚æ•°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®¾ç½®å‚æ•°": {
      "main": [
        [
          {
            "node": "è·å–å¤©æ°”",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·å–å¤©æ°”": {
      "main": [
        [
          {
            "node": "æ ¼å¼åŒ–é‚®ä»¶",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ ¼å¼åŒ–é‚®ä»¶": {
      "main": [
        [
          {
            "node": "å‘é€é‚®ä»¶",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "timezone": "Asia/Shanghai"
  },
  "staticData": null,
  "tags": [],
  "active": false
} 